<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RescueNote - æ¶ˆé˜²è·å“¡ãƒ¡ãƒ³ã‚¿ãƒ«ãƒ­ã‚°</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel (JSXå¤‰æ›ç”¨) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body { font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif; }
        .animate-fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- ã‚¢ã‚¤ã‚³ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ (Lucideä»£æ›¿SVG) ---
        const Icon = ({ path, className }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className}
            >
                {path}
            </svg>
        );

        const Icons = {
            ShieldAlert: (props) => <Icon {...props} path={<><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></>} />,
            BookOpen: (props) => <Icon {...props} path={<><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></>} />,
            MessageSquarePlus: (props) => <Icon {...props} path={<><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/><line x1="9" y1="10" x2="15" y2="10"/><line x1="12" y1="7" x2="12" y2="13"/></>} />,
            Activity: (props) => <Icon {...props} path={<polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>} />,
            Heart: (props) => <Icon {...props} path={<path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>} />,
            Wind: (props) => <Icon {...props} path={<><path d="M9.59 4.59A2 2 0 1 1 11 8H2m10.59 11.41A2 2 0 1 0 14 16H2m15.73-8.27A2.5 2.5 0 1 1 19.5 12H2"/></>} />,
            Trash2: (props) => <Icon {...props} path={<><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></>} />,
            Save: (props) => <Icon {...props} path={<><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></>} />,
            Menu: (props) => <Icon {...props} path={<><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></>} />,
            X: (props) => <Icon {...props} path={<><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></>} />,
            AlertTriangle: (props) => <Icon {...props} path={<><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></>} />,
            CheckCircle2: (props) => <Icon {...props} path={<><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></>} />,
        };

        // --- ãƒ­ã‚¸ãƒƒã‚¯ & ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ ---

        // æ·»ä»˜è³‡æ–™ã«åŸºã¥ã„ãŸã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰åˆ†æãƒ­ã‚¸ãƒƒã‚¯
        const analyzeContent = (text) => {
            const tags = [];
            const guidances = [];
            let score = 0;

            // 1. æ‚²æƒ¨ãªç¾å ´ãƒ»è¦–è¦šçš„ã‚·ãƒ§ãƒƒã‚¯
            if (text.match(/éºä½“|æå‚·|è…æ•—|å‡„æƒ¨|è¡€|åƒåˆ‡|ç›®æ’ƒ/)) {
                tags.push('è¦–è¦šçš„ã‚·ãƒ§ãƒƒã‚¯');
                score += 2;
                guidances.push({
                title: 'è¦–è¦šçš„ã‚¤ãƒ¡ãƒ¼ã‚¸ã®é®æ–­',
                description: 'å¼·çƒˆãªè¦–è¦šä½“é¨“ã¯ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒãƒƒã‚¯ã®åŸå› ã«ãªã‚Šã‚„ã™ã„ã§ã™ã€‚',
                action: 'æ„å›³çš„ã«ã€Œãƒ†ãƒ¬ãƒ“ã®ãƒãƒ£ãƒ³ãƒãƒ«ã‚’å¤‰ãˆã‚‹ã€ã‚ˆã†ã«ã€åˆ¥ã®æ˜ åƒã‚„é¢¨æ™¯ã‚’æ€ã„æµ®ã‹ã¹ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚',
                sourceDoc: 'æƒ¨äº‹ã‚¹ãƒˆãƒ¬ã‚¹å¯¾ç­–ãƒãƒ‹ãƒ¥ã‚¢ãƒ«'
                });
            }

            // 2. å­ä¾›ãƒ»å®¶æ—é–¢é€£
            if (text.match(/å­ä¾›|å­ã©ã‚‚|å¹¼å…|å…ç«¥|å®¶æ—|è¦ª|æ³£ãå£°/)) {
                tags.push('å…±æ„Ÿæ€§ã‚¹ãƒˆãƒ¬ã‚¹');
                score += 3;
                guidances.push({
                title: 'è‡ªåˆ†ã¨ç¾å ´ã®åˆ†é›¢',
                description: 'è‡ªèº«ã®å®¶æ—ã¨é‡ã­åˆã‚ã›ã¦ã—ã¾ã†ã“ã¨ã¯ã€æœ€ã‚‚å¼·ã„ã‚¹ãƒˆãƒ¬ãƒƒã‚µãƒ¼ã®ä¸€ã¤ã§ã™ã€‚',
                action: 'ã€Œã“ã‚Œã¯ä»•äº‹ã§ã‚ã‚‹ã€ã¨å£°ã«å‡ºã—ã¦åŒºåˆ‡ã‚Šã‚’ã¤ã‘ã¦ãã ã•ã„ã€‚å¸°å®…å¾Œã¯å®¶æ—ã¨ã®ã‚¹ã‚­ãƒ³ã‚·ãƒƒãƒ—ã‚’å¤§åˆ‡ã«ã—ã€ç¾å®Ÿã®å¹³ç©ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚',
                sourceDoc: 'ä»¤å’Œ2å¹´7æœˆè±ªé›¨ã«ä¿‚ã‚‹å¯¾ç­–è³‡æ–™'
                });
            }

            // 3. ç„¡åŠ›æ„Ÿãƒ»è‡ªè²¬
            if (text.match(/åŠ©ã‘ã‚‰ã‚Œãªã‹ã£ãŸ|é–“ã«åˆã‚ãªã‹ã£ãŸ|ã‚‚ã£ã¨|è‡ªåˆ†ã®ã›ã„|ãƒŸã‚¹|å¤±æ•—/)) {
                tags.push('è‡ªè²¬ãƒ»ç„¡åŠ›æ„Ÿ');
                score += 3;
                guidances.push({
                title: 'ã‚µãƒã‚¤ãƒãƒ¼ã‚ºãƒ»ã‚®ãƒ«ãƒˆã¸ã®å¯¾å‡¦',
                description: 'ã€Œã‚‚ã£ã¨ä½•ã‹ã§ããŸã¯ãšã ã€ã¨ã„ã†æ€ã„ã¯ã€è²¬ä»»æ„Ÿã®å¼·ã•ã®è£è¿”ã—ã§ã‚ã‚Šã€æ­£å¸¸ãªåå¿œã§ã™ã€‚',
                action: 'æ´»å‹•ã¯ãƒãƒ¼ãƒ ã§è¡Œã£ãŸã‚‚ã®ã§ã™ã€‚çµæœã‚’å€‹äººã®è²¬ä»»ã ã‘ã«å¸°çµã•ã›ãšã€åŒåƒšã¨ã€Œã‚ã®æ™‚ã©ã†å‹•ãã®ãŒæœ€å–„ã ã£ãŸã‹ã€ã‚’æŠ€è¡“çš„ã«è©±ã—åˆã†ï¼ˆãƒ‡ãƒ•ãƒ¥ãƒ¼ã‚¸ãƒ³ã‚°ï¼‰æ©Ÿä¼šã‚’æŒã£ã¦ãã ã•ã„ã€‚',
                sourceDoc: 'æ¶ˆé˜²è·å“¡ã®æƒ¨äº‹ã‚¹ãƒˆãƒ¬ã‚¹å¯¾ç­–ï½ã¨ã«ã‹ãã—ã‚ƒã¹ã£ã¦ã‚‚ã‚‰ã†ã“ã¨ï½'
                });
            }

            // 4. èº«ä½“åå¿œ
            if (text.match(/çœ ã‚Œãªã„|å¯ã‚Œãªã„|æ‚ªå¤¢|é£Ÿæ¬²|åãæ°—|éœ‡ãˆ|å‹•æ‚¸|æ±—/)) {
                tags.push('èº«ä½“åŒ–åå¿œ');
                score += 2;
                guidances.push({
                title: 'èº«ä½“åå¿œã®ã‚±ã‚¢',
                description: 'èº«ä½“ã«å‡ºã‚‹åå¿œã¯ã€ä½“ãŒã€Œä¼‘ã‚ã€ã¨ã‚µã‚¤ãƒ³ã‚’å‡ºã—ã¦ã„ã‚‹è¨¼æ‹ ã§ã™ã€‚',
                action: '48æ™‚é–“ã¯ã‚«ãƒ•ã‚§ã‚¤ãƒ³ã‚„ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ã‚’æ§ãˆã€ã¬ã‚‹ã‚ã®ãŠé¢¨å‘‚ã«ã‚†ã£ãã‚Šæµ¸ã‹ã£ã¦ãã ã•ã„ã€‚çœ ã‚Œãªãã¦ã‚‚ã€Œæ¨ªã«ãªã‚‹ã ã‘ã§ä½“ã¯ä¼‘ã¾ã‚‹ã€ã¨è€ƒãˆã¦ãã ã•ã„ã€‚',
                sourceDoc: 'ãƒ©ã‚¤ãƒ•ã‚»ãƒ¼ãƒãƒ¼ã®ãŸã‚ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³'
                });
            }

            // 5. æ„Ÿæƒ…ã®éº»ç—º
            if (text.match(/ä½•ã‚‚æ„Ÿã˜ãªã„|ç¾å®Ÿæ„ŸãŒãªã„|ã¼ãƒ¼ã£ã¨ã™ã‚‹|æ¶™ãŒå‡ºãªã„/)) {
                tags.push('è§£é›¢ãƒ»å›é¿');
                score += 2;
                guidances.push({
                title: 'æ„Ÿæƒ…ã®é˜²è¡›åå¿œ',
                description: 'ä½•ã‚‚æ„Ÿã˜ãªã„ã®ã¯ã€å¿ƒãŒè¡æ’ƒã‹ã‚‰èº«ã‚’å®ˆã‚ã†ã¨ã—ã¦ã„ã‚‹ã€Œæ­£å¸¸ãªé˜²è¡›åå¿œã€ã§ã™ã€‚',
                action: 'ç„¡ç†ã«æ„Ÿæƒ…ã‚’å‡ºãã†ã¨ã›ãšã€ä»Šã¯æ·¡ã€…ã¨ãƒ«ãƒ¼ãƒãƒ³ãƒ¯ãƒ¼ã‚¯ã‚’ã“ãªã—ã¦ãã ã•ã„ã€‚æ•°æ—¥å¾Œã«æ„Ÿæƒ…ãŒæ¹§ãä¸ŠãŒã£ã¦ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚',
                sourceDoc: '1.æƒ¨äº‹ã‚¹ãƒˆãƒ¬ã‚¹ã¨ã¯'
                });
            }

            // ãƒ¬ãƒ™ãƒ«åˆ¤å®š
            let level = 'low';
            if (score >= 4) level = 'high';
            else if (score >= 2) level = 'medium';

            return { tags, level, guidances };
        };

        const BreathingExercise = () => {
            const [phase, setPhase] = useState('inhale');
            const [count, setCount] = useState(4);

            useEffect(() => {
                const timer = setInterval(() => {
                setCount((c) => {
                    if (c === 1) {
                    setPhase((p) => {
                        if (p === 'inhale') return 'hold';
                        if (p === 'hold') return 'exhale';
                        if (p === 'exhale') return 'hold2';
                        return 'inhale';
                    });
                    return 4;
                    }
                    return c - 1;
                });
                }, 1000);
                return () => clearInterval(timer);
            }, []);

            const getInstruction = () => {
                switch (phase) {
                case 'inhale': return 'é¼»ã‹ã‚‰å¸ã†';
                case 'hold': return 'æ­¢ã‚ã‚‹';
                case 'exhale': return 'å£ã‹ã‚‰åã';
                case 'hold2': return 'æ­¢ã‚ã‚‹';
                }
            };

            return (
                <div className="bg-blue-50 p-4 rounded-xl flex flex-col items-center justify-center space-y-4 shadow-inner">
                <h3 className="text-sm font-bold text-blue-800 flex items-center gap-2">
                    <Icons.Wind className="w-4 h-4" />
                    ã‚¿ã‚¯ãƒ†ã‚£ã‚«ãƒ«ãƒ»ãƒ–ãƒªãƒ¼ã‚¸ãƒ³ã‚°ï¼ˆç·Šå¼µç·©å’Œï¼‰
                </h3>
                <div className={`
                    w-24 h-24 rounded-full flex items-center justify-center transition-all duration-1000 border-4
                    ${phase === 'inhale' ? 'bg-blue-200 scale-110 border-blue-400' : ''}
                    ${phase === 'hold' || phase === 'hold2' ? 'bg-blue-300 scale-110 border-blue-500' : ''}
                    ${phase === 'exhale' ? 'bg-blue-100 scale-90 border-blue-300' : ''}
                `}>
                    <span className="text-2xl font-bold text-blue-900">{count}</span>
                </div>
                <p className="text-blue-900 font-medium">{getInstruction()}</p>
                </div>
            );
        };

        const NoteCard = ({ note, onDelete }) => {
            const { guidances } = analyzeContent(note.content);

            return (
                <div className="bg-white border border-gray-200 rounded-xl p-6 mb-4 shadow-sm hover:shadow-md transition-shadow animate-fade-in">
                <div className="flex justify-between items-start mb-3">
                    <div className="flex flex-wrap gap-2">
                    {note.tags.map(tag => (
                        <span key={tag} className="px-2 py-1 bg-slate-100 text-slate-600 text-xs rounded-full font-medium">
                        #{tag}
                        </span>
                    ))}
                    {note.stressLevel === 'high' && (
                        <span className="px-2 py-1 bg-red-100 text-red-600 text-xs rounded-full font-bold flex items-center gap-1">
                        <Icons.AlertTriangle className="w-3 h-3" /> è¦ã‚±ã‚¢
                        </span>
                    )}
                    </div>
                    <button onClick={() => onDelete(note.id)} className="text-gray-400 hover:text-red-500 transition-colors">
                    <Icons.Trash2 className="w-4 h-4" />
                    </button>
                </div>

                <p className="text-gray-800 whitespace-pre-wrap leading-relaxed mb-6 font-medium">
                    {note.content}
                </p>

                {/* AI Analysis Section */}
                <div className="space-y-3">
                    <h4 className="text-xs font-bold text-slate-400 uppercase tracking-wider flex items-center gap-1">
                    <Icons.Activity className="w-3 h-3" />
                    æƒ¨äº‹ã‚¹ãƒˆãƒ¬ã‚¹ãƒ»ã‚¬ã‚¤ãƒ‰
                    </h4>
                    
                    {guidances.length > 0 ? (
                    guidances.map((g, idx) => (
                        <div key={idx} className="bg-slate-50 border-l-4 border-indigo-400 p-4 rounded-r-lg">
                        <h5 className="font-bold text-slate-800 text-sm mb-1">{g.title}</h5>
                        <p className="text-slate-600 text-sm mb-2">{g.description}</p>
                        <div className="bg-white p-3 rounded border border-slate-200 text-sm text-indigo-700 font-medium">
                            ğŸ’¡ {g.action}
                        </div>
                        {g.sourceDoc && (
                            <div className="mt-2 text-xs text-slate-400 text-right">
                            å‡ºå…¸: {g.sourceDoc}
                            </div>
                        )}
                        </div>
                    ))
                    ) : (
                    <div className="bg-green-50 p-4 rounded-lg text-green-800 text-sm">
                        <div className="flex items-center gap-2 mb-1 font-bold">
                        <Icons.CheckCircle2 className="w-4 h-4" />
                        è¨˜éŒ²å®Œäº†
                        </div>
                        ä»Šã®ã¨ã“ã‚ã€æ–‡ç« ã‹ã‚‰å¼·ã„ãƒªã‚¹ã‚¯ãƒ¯ãƒ¼ãƒ‰ã¯æ¤œå‡ºã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚
                        ã—ã‹ã—ã€æ›¸ãã“ã¨è‡ªä½“ãŒã€Œãƒ‡ãƒ•ãƒ¥ãƒ¼ã‚¸ãƒ³ã‚°ï¼ˆã‚¬ã‚¹æŠœãï¼‰ã€ã®åŠ¹æœã‚’æŒã¡ã¾ã™ã€‚
                        å°‘ã—ã§ã‚‚é•å’Œæ„ŸãŒã‚ã‚Œã°ã€ç¶™ç¶šã—ã¦è¨˜éŒ²ã‚’ã¤ã‘ã¦ãã ã•ã„ã€‚
                    </div>
                    )}
                </div>
                
                <div className="mt-4 pt-4 border-t border-gray-100 text-xs text-gray-400 flex justify-between">
                    <span>{note.timestamp.toLocaleString()}</span>
                    <span>ID: {note.id.slice(0,8)}</span>
                </div>
                </div>
            );
        };

        const RescueNoteApp = () => {
            const [notes, setNotes] = useState([]);
            const [inputText, setInputText] = useState('');
            const [view, setView] = useState('notes');
            const [isSidebarOpen, setIsSidebarOpen] = useState(true);

            // 1åˆ†é–“ãƒã‚§ãƒƒã‚¯ç”¨ã‚¹ãƒ†ãƒ¼ãƒˆ
            const [checkList, setCheckList] = useState({
                sleep: false,
                flashback: false,
                irritation: false,
                avoidance: false,
                numbness: false,
                guilt: false
            });
            const [checkResult, setCheckResult] = useState(null);

            const addNote = () => {
                if (!inputText.trim()) return;

                const analysis = analyzeContent(inputText);
                
                const newNote = {
                id: crypto.randomUUID(),
                content: inputText,
                timestamp: new Date(),
                tags: analysis.tags,
                stressLevel: analysis.level
                };

                setNotes([newNote, ...notes]);
                setInputText('');
            };

            const deleteNote = (id) => {
                setNotes(notes.filter(n => n.id !== id));
            };

            const handleCheck = () => {
                const count = Object.values(checkList).filter(Boolean).length;
                if (count >= 3) {
                setCheckResult("è­¦æˆ’ãƒ¬ãƒ™ãƒ«: å°‚é–€å®¶ã¾ãŸã¯ãƒ”ã‚¢ã‚µãƒãƒ¼ã‚¿ãƒ¼ã¸ã®ç›¸è«‡ã‚’å¼·ãæ¨å¥¨ã—ã¾ã™ã€‚ã‚ãªãŸã¯ä¸€äººã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚");
                } else if (count >= 1) {
                setCheckResult("æ³¨æ„ãƒ¬ãƒ™ãƒ«: ã‚¹ãƒˆãƒ¬ã‚¹åå¿œãŒå‡ºã¦ã„ã¾ã™ã€‚ã“ã®ã‚¢ãƒ—ãƒªã§æ°—æŒã¡ã‚’åãå‡ºã—ã€ååˆ†ãªä¼‘æ¯ã‚’ã¨ã£ã¦ãã ã•ã„ã€‚");
                } else {
                setCheckResult("æ­£å¸¸ç¯„å›²: ä»Šã®ã¨ã“ã‚å®‰å®šã—ã¦ã„ã¾ã™ãŒã€ç½å®³å¾Œã¯å¤‰åŒ–ã—ã‚„ã™ã„ã‚‚ã®ã§ã™ã€‚ç¶™ç¶šçš„ãªã‚»ãƒ«ãƒ•ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã‚’ã€‚");
                }
            };

            return (
                <div className="flex h-screen bg-slate-100 text-slate-800 font-sans overflow-hidden">
                
                {/* Sidebar */}
                <aside className={`${isSidebarOpen ? 'w-80' : 'w-0'} bg-slate-900 text-slate-300 transition-all duration-300 flex flex-col border-r border-slate-800 overflow-hidden relative`}>
                    <div className="p-6 border-b border-slate-700 flex justify-between items-center w-80">
                    <div>
                        <h1 className="text-white font-bold text-xl tracking-tight flex items-center gap-2">
                        <Icons.ShieldAlert className="text-red-500 w-6 h-6" />
                        RescueNote
                        </h1>
                        <p className="text-xs text-slate-400 mt-1">æ¶ˆé˜²è·å“¡ãƒ¡ãƒ³ã‚¿ãƒ«ãƒ­ã‚°</p>
                    </div>
                    <button onClick={() => setIsSidebarOpen(false)} className="md:hidden">
                        <Icons.X className="w-5 h-5" />
                    </button>
                    </div>

                    <nav className="flex-1 p-4 space-y-2 overflow-y-auto w-80">
                    <button 
                        onClick={() => setView('notes')}
                        className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${view === 'notes' ? 'bg-indigo-600 text-white' : 'hover:bg-slate-800'}`}
                    >
                        <Icons.BookOpen className="w-5 h-5" />
                        <div className="text-left">
                        <span className="block font-medium">æ´»å‹•è¨˜éŒ²ã¨åˆ†æ</span>
                        <span className="text-xs opacity-70">æ—¥ã€…ã®ãƒ‡ãƒ•ãƒ¥ãƒ¼ã‚¸ãƒ³ã‚°</span>
                        </div>
                    </button>

                    <button 
                        onClick={() => setView('check')}
                        className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${view === 'check' ? 'bg-indigo-600 text-white' : 'hover:bg-slate-800'}`}
                    >
                        <Icons.Activity className="w-5 h-5" />
                        <div className="text-left">
                        <span className="block font-medium">1åˆ†é–“ãƒã‚§ãƒƒã‚¯</span>
                        <span className="text-xs opacity-70">ä»Šã®çŠ¶æ…‹ã‚’ç¢ºèª</span>
                        </div>
                    </button>

                    <div className="pt-6 pb-2">
                        <h3 className="px-4 text-xs font-bold text-slate-500 uppercase tracking-wider">ã‚¯ã‚¤ãƒƒã‚¯ãƒ»ãƒ„ãƒ¼ãƒ«</h3>
                    </div>

                    <div className="px-4 mb-6">
                        <BreathingExercise />
                    </div>

                    <div className="px-4 py-4 bg-slate-800 rounded-lg text-xs space-y-2">
                        <h4 className="font-bold text-white flex items-center gap-2">
                        <Icons.Heart className="w-3 h-3 text-pink-500" />
                        ç·Šæ€¥æ™‚ã‚µãƒãƒ¼ãƒˆ
                        </h4>
                        <p>ã¤ã‚‰ã„æ™‚ã¯èºŠèº‡ãªãé€£çµ¡ã‚’ã€‚</p>
                        <ul className="list-disc pl-4 space-y-1 text-slate-400">
                        <li>æ‰€å±ã®æŒ‡å®šç”£æ¥­åŒ»</li>
                        <li>ç·Šæ€¥æ™‚ãƒ¡ãƒ³ã‚¿ãƒ«ã‚µãƒãƒ¼ãƒˆãƒãƒ¼ãƒ </li>
                        <li>å…±æ¸ˆçµ„åˆç›¸è«‡çª“å£</li>
                        </ul>
                    </div>
                    </nav>

                    <div className="p-4 border-t border-slate-800 text-xs text-center text-slate-500 w-80">
                    ãƒ‡ãƒ¼ã‚¿ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã«ã®ã¿ä¿å­˜ã•ã‚Œã¾ã™ã€‚<br/>
                    ã‚¿ãƒ–ã‚’é–‰ã˜ã‚‹ã¨ãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã™ã€‚
                    </div>
                </aside>

                {/* Main Content */}
                <main className="flex-1 flex flex-col h-full overflow-hidden relative">
                    {/* Header */}
                    <header className="h-16 bg-white border-b border-gray-200 flex items-center px-6 justify-between flex-shrink-0 z-10">
                    <div className="flex items-center gap-4">
                        {!isSidebarOpen && (
                        <button onClick={() => setIsSidebarOpen(true)} className="p-2 hover:bg-gray-100 rounded-full text-gray-600">
                            <Icons.Menu className="w-5 h-5" />
                        </button>
                        )}
                        <h2 className="font-bold text-lg text-gray-800">
                        {view === 'notes' && 'ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒ»ãƒ­ã‚°'}
                        {view === 'check' && 'ã‚»ãƒ«ãƒ•ãƒ»ãƒˆãƒªã‚¢ãƒ¼ã‚¸'}
                        </h2>
                    </div>
                    <div className="flex items-center gap-2">
                        <span className="bg-gray-100 text-gray-600 px-3 py-1 rounded-full text-xs font-bold">
                        {new Date().toLocaleDateString('ja-JP', { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' })}
                        </span>
                    </div>
                    </header>

                    {/* Scrollable Content Area */}
                    <div className="flex-1 overflow-y-auto bg-slate-50 p-4 md:p-8">
                    <div className="max-w-4xl mx-auto">
                        
                        {view === 'notes' && (
                        <div className="grid grid-cols-1 lg:grid-cols-12 gap-6">
                            {/* Input Area (Left/Top) */}
                            <div className="lg:col-span-5 space-y-4">
                            <div className="bg-white p-5 rounded-xl shadow-sm border border-gray-200 sticky top-4">
                                <h3 className="text-sm font-bold text-gray-500 mb-3 flex items-center gap-2">
                                <Icons.MessageSquarePlus className="w-4 h-4" />
                                æ–°è¦è¨˜éŒ²ï¼ˆåãå‡ºã—ï¼‰
                                </h3>
                                <p className="text-xs text-gray-400 mb-4">
                                ç¾å ´ã§ã®å‡ºæ¥äº‹ã€æ„Ÿã˜ãŸé•å’Œæ„Ÿã€æ€’ã‚Šã€æ‚²ã—ã¿ãªã©ã‚’ãã®ã¾ã¾æ›¸ãå‡ºã—ã¦ãã ã•ã„ã€‚
                                AIãƒ­ã‚¸ãƒƒã‚¯ãŒå†…å®¹ã‚’åˆ†æã—ã€ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã«åŸºã¥ã„ãŸã‚±ã‚¢æ–¹æ³•ã‚’ææ¡ˆã—ã¾ã™ã€‚
                                </p>
                                <textarea
                                value={inputText}
                                onChange={(e) => setInputText(e.target.value)}
                                placeholder="ä¾‹ï¼šä»Šæ—¥ã®ç¾å ´ã¯å³ã—ã‹ã£ãŸã€‚å­ä¾›ã®é´ãŒè½ã¡ã¦ã„ã‚‹ã®ã‚’è¦‹ã¦ã€è‡ªåˆ†ã®å¨˜ã®ã“ã¨ã‚’æ€ã„å‡ºã—ã¦ã—ã¾ã„ã€æ‰‹ãŒéœ‡ãˆãŸ..."
                                className="w-full h-48 p-4 bg-gray-50 rounded-lg border border-gray-200 focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none text-sm leading-relaxed mb-3"
                                />
                                <div className="flex justify-end">
                                <button 
                                    onClick={addNote}
                                    disabled={!inputText.trim()}
                                    className="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg font-bold text-sm transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"
                                >
                                    <Icons.Save className="w-4 h-4" />
                                    è¨˜éŒ²ãƒ»åˆ†æ
                                </button>
                                </div>
                            </div>
                            </div>

                            {/* List Area (Right/Bottom) */}
                            <div className="lg:col-span-7">
                            <div className="flex items-center justify-between mb-4">
                                <h3 className="text-sm font-bold text-gray-500">ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³</h3>
                                <span className="text-xs text-gray-400">{notes.length}ä»¶ã®è¨˜éŒ²</span>
                            </div>
                            
                            {notes.length === 0 ? (
                                <div className="text-center py-20 bg-white rounded-xl border border-dashed border-gray-300">
                                <Icons.BookOpen className="w-12 h-12 text-gray-300 mx-auto mb-3" />
                                <p className="text-gray-400 text-sm">ã¾ã è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“ã€‚<br/>å·¦ã®ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰ä»Šã®æ°—æŒã¡ã‚’æ›¸ãå‡ºã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
                                </div>
                            ) : (
                                <div className="space-y-4">
                                {notes.map(note => (
                                    <NoteCard key={note.id} note={note} onDelete={deleteNote} />
                                ))}
                                </div>
                            )}
                            </div>
                        </div>
                        )}

                        {view === 'check' && (
                        <div className="max-w-2xl mx-auto bg-white p-8 rounded-xl shadow-sm border border-gray-200">
                            <div className="mb-8 text-center">
                            <h3 className="text-2xl font-bold text-gray-800 mb-2">ç°¡æ˜“ã‚¹ãƒˆãƒ¬ã‚¹ãƒã‚§ãƒƒã‚¯</h3>
                            <p className="text-gray-500 text-sm">
                                ç›´è¿‘1ãƒ¶æœˆï¼ˆã¾ãŸã¯ç›´è¿‘ã®ç½å®³å‡ºå‹•å¾Œï¼‰ã®ã‚ãªãŸã®çŠ¶æ…‹ã«ã¤ã„ã¦ã€<br/>
                                å½“ã¦ã¯ã¾ã‚‹ã‚‚ã®ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¦ãã ã•ã„ã€‚
                            </p>
                            </div>

                            <div className="space-y-4 mb-8">
                            {[
                                { id: 'sleep', label: 'ãªã‹ãªã‹å¯ä»˜ã‘ãªã„ã€ã¾ãŸã¯å¤œä¸­ã«ä½•åº¦ã‚‚ç›®ãŒè¦šã‚ã‚‹ï¼ˆä¸çœ ï¼‰' },
                                { id: 'flashback', label: 'ç¾å ´ã®å…‰æ™¯ã‚„éŸ³ãŒã€ãµã¨ã—ãŸç¬é–“ã«çªç„¶ã‚ˆã¿ãŒãˆã‚‹ï¼ˆå†ä½“é¨“ï¼‰' },
                                { id: 'irritation', label: 'ä»¥å‰ã‚ˆã‚Šäº›ç´°ãªã“ã¨ã§ã‚¤ãƒ©ã‚¤ãƒ©ã—ãŸã‚Šã€æ€’ã‚Šã£ã½ããªã£ãŸï¼ˆéè¦šé†’ï¼‰' },
                                { id: 'avoidance', label: 'ç¾å ´ã‚’æ€ã„å‡ºã•ã›ã‚‹å ´æ‰€ã€äººã€è©±é¡Œã‚’ç„¡æ„è­˜ã«é¿ã‘ã¦ã„ã‚‹ï¼ˆå›é¿ï¼‰' },
                                { id: 'numbness', label: 'æ‚²ã—ã¿ã‚„å–œã³ãªã©ã€æ„Ÿæƒ…ãŒéº»ç—ºã—ã¦ã„ã‚‹ã‚ˆã†ã«æ„Ÿã˜ã‚‹ï¼ˆè§£é›¢ï¼‰' },
                                { id: 'guilt', label: 'ã€Œã‚‚ã£ã¨ä½•ã‹ã§ããŸã¯ãšã ã€ã¨è‡ªåˆ†ã‚’è²¬ã‚ã¦ã—ã¾ã†ï¼ˆè‡ªè²¬ï¼‰' },
                            ].map((item) => (
                                <label key={item.id} className={`flex items-start p-4 rounded-lg border cursor-pointer transition-all ${
                                checkList[item.id] ? 'bg-indigo-50 border-indigo-500' : 'bg-gray-50 border-gray-200 hover:bg-gray-100'
                                }`}>
                                <input 
                                    type="checkbox" 
                                    className="mt-1 w-5 h-5 text-indigo-600 rounded focus:ring-indigo-500"
                                    checked={checkList[item.id]}
                                    onChange={() => setCheckList(prev => ({...prev, [item.id]: !prev[item.id]}))}
                                />
                                <span className="ml-3 text-gray-700 font-medium">{item.label}</span>
                                </label>
                            ))}
                            </div>

                            <div className="flex justify-center mb-6">
                            <button 
                                onClick={handleCheck}
                                className="bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-3 rounded-xl font-bold text-lg transition-transform hover:scale-105 active:scale-95 shadow-lg shadow-indigo-200"
                            >
                                è¨ºæ–­ã™ã‚‹
                            </button>
                            </div>

                            {checkResult && (
                            <div className={`p-6 rounded-xl text-center animate-fade-in ${checkResult.includes("è­¦æˆ’") ? "bg-red-50 text-red-800 border border-red-200" : checkResult.includes("æ³¨æ„") ? "bg-orange-50 text-orange-800 border border-orange-200" : "bg-green-50 text-green-800 border border-green-200"}`}>
                                <h4 className="font-bold text-lg mb-2">åˆ¤å®šçµæœ</h4>
                                <p>{checkResult}</p>
                            </div>
                            )}
                            
                            <div className="mt-8 p-4 bg-slate-50 rounded-lg text-xs text-slate-500">
                            <p>â€»ã“ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã¯ã€IES-Rï¼ˆæ”¹è¨‚å‡ºæ¥äº‹ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆå°ºåº¦ï¼‰ãªã©ã®æ—¢å­˜æŒ‡æ¨™ã‚’ç°¡ç•¥åŒ–ã—ãŸã‚‚ã®ã§ã‚ã‚Šã€åŒ»å­¦çš„ãªè¨ºæ–­ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
                            </div>
                        </div>
                        )}

                    </div>
                    </div>
                </main>

                {/* Floating Action Button for Mobile */}
                <div className="fixed bottom-6 right-6 md:hidden">
                    <button 
                    onClick={() => setView('notes')}
                    className="bg-indigo-600 text-white p-4 rounded-full shadow-xl hover:bg-indigo-700"
                    >
                    <Icons.MessageSquarePlus className="w-6 h-6" />
                    </button>
                </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<RescueNoteApp />);
    </script>
</body>
</html>
