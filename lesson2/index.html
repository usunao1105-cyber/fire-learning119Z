<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>緊急車両コメンタリー運転評価</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        @media print {
            body { -webkit-print-color-adjust: exact; }
            .no-print { display: none !important; }
        }
    </style>
</head>
<body class="bg-gray-100">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- アイコンコンポーネント (Lucide Icons) ---
        // 外部依存を避けるためSVGを直接定義
        const IconBase = ({ children, ...props }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>{children}</svg>
        );

        const AlertTriangle = (props) => <IconBase {...props}><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><path d="M12 9v4"/><path d="M12 17h.01"/></IconBase>;
        const CheckCircle = (props) => <IconBase {...props}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></IconBase>;
        const Clock = (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></IconBase>;
        const RotateCcw = (props) => <IconBase {...props}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></IconBase>;
        const Save = (props) => <IconBase {...props}><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></IconBase>;
        const User = (props) => <IconBase {...props}><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></IconBase>;
        const Mic = (props) => <IconBase {...props}><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></IconBase>;
        const Eye = (props) => <IconBase {...props}><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></IconBase>;
        const Activity = (props) => <IconBase {...props}><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></IconBase>;
        const MapPin = (props) => <IconBase {...props}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></IconBase>;
        const Truck = (props) => <IconBase {...props}><path d="M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11"/><path d="M14 9h4l4 4v4c0 .6-.4 1-1 1h-2"/><circle cx="7" cy="18" r="2"/><circle cx="17" cy="18" r="2"/></IconBase>;
        const MapIcon = (props) => <IconBase {...props}><polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"/><line x1="8" y1="2" x2="8" y2="18"/><line x1="16" y1="6" x2="16" y2="22"/></IconBase>;
        const Milestone = (props) => <IconBase {...props}><path d="M18 6H5a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h13l4-3.5L18 6Z"/><path d="M12 13v8"/><path d="M12 3v3"/></IconBase>;

        // --- メインアプリケーション ---
        function App() {
            const [view, setView] = useState('setup'); // setup, exam, result
            const [driverName, setDriverName] = useState('');
            const [evaluatorName, setEvaluatorName] = useState('');
            const [examDate, setExamDate] = useState(new Date().toISOString().split('T')[0]);
            
            // 新規追加項目
            const [vehicleType, setVehicleType] = useState('');
            const [route, setRoute] = useState('');
            const [distance, setDistance] = useState('');

            const [score, setScore] = useState(100);
            const [logs, setLogs] = useState([]);
            const [timer, setTimer] = useState(0);
            const [isTimerRunning, setIsTimerRunning] = useState(false);
            
            // モーダル管理用ステート
            const [modal, setModal] = useState(null); // null | { title, message, onConfirm, confirmText, isDestructive }

            // 基準点（合格ライン）
            const PASSING_SCORE = 70;

            // タイマー処理
            useEffect(() => {
                let interval = null;
                if (isTimerRunning) {
                interval = setInterval(() => {
                    setTimer((prev) => prev + 1);
                }, 1000);
                } else if (!isTimerRunning && timer !== 0) {
                clearInterval(interval);
                }
                return () => clearInterval(interval);
            }, [isTimerRunning, timer]);

            const formatTime = (seconds) => {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            };

            // 評価項目データ
            const evaluationItems = [
                {
                category: '安全確認',
                icon: <Eye className="w-5 h-5" />,
                color: 'bg-blue-100 text-blue-800 border-blue-200',
                items: [
                    { id: 'check_lr', label: '左右確認不足', points: 10 },
                    { id: 'check_mirror', label: 'ミラー確認不足', points: 5 },
                    { id: 'check_visual', label: '目視確認不足', points: 10 },
                ]
                },
                {
                category: 'コメンタリー(発声)',
                icon: <Mic className="w-5 h-5" />,
                color: 'bg-purple-100 text-purple-800 border-purple-200',
                items: [
                    { id: 'voice_none', label: '無発声・沈黙', points: 10 },
                    { id: 'voice_small', label: '声が小さい/不明瞭', points: 5 },
                    { id: 'voice_late', label: '発声のタイミング遅れ', points: 5 },
                    { id: 'voice_content', label: '呼称内容の不適切', points: 5 },
                ]
                },
                {
                category: '交差点・通過',
                icon: <MapPin className="w-5 h-5" />,
                color: 'bg-orange-100 text-orange-800 border-orange-200',
                items: [
                    { id: 'cross_speed', label: '交差点進入速度超過', points: 15 },
                    { id: 'cross_stop', label: '一時停止不履行', points: 20 },
                    { id: 'signal_ignore', label: '信号予測・対応不備', points: 10 },
                ]
                },
                {
                category: '車両操作・挙動',
                icon: <Activity className="w-5 h-5" />,
                color: 'bg-red-100 text-red-800 border-red-200',
                items: [
                    { id: 'ops_brake', label: '急ブレーキ', points: 10 },
                    { id: 'ops_handle', label: '急ハンドル', points: 10 },
                    { id: 'ops_speed', label: '速度超過', points: 20 },
                    { id: 'ops_smooth', label: '不円滑な操作', points: 5 },
                ]
                }
            ];

            // --- アクション ---

            // モーダル表示ヘルパー
            const showConfirm = (config) => {
                setModal(config);
            };
            
            const closeModal = () => {
                setModal(null);
            };

            const startExam = () => {
                if (!driverName || !vehicleType) {
                showConfirm({
                    title: "入力エラー",
                    message: "受検者名と車両タイプは必須項目です。",
                    confirmText: "OK",
                    onConfirm: () => closeModal(),
                    isAlert: true
                });
                return;
                }
                setScore(100);
                setLogs([]);
                setTimer(0);
                setIsTimerRunning(true);
                setView('exam');
            };

            const handleDeduct = (item) => {
                const newLog = {
                id: Date.now(),
                itemId: item.id,
                label: item.label,
                points: item.points,
                time: timer,
                timestamp: new Date().toLocaleTimeString()
                };
                
                setLogs([newLog, ...logs]);
                setScore((prev) => Math.max(0, prev - item.points));
            };

            const undoDeduct = (logId) => {
                const targetLog = logs.find(l => l.id === logId);
                if (targetLog) {
                setScore((prev) => Math.min(100, prev + targetLog.points));
                setLogs(logs.filter(l => l.id !== logId));
                }
            };

            // 試験終了アクション
            const finishExam = () => {
                showConfirm({
                title: "試験終了の確認",
                message: "試験を終了し、結果画面へ移動しますか？この操作は取り消せません。",
                confirmText: "終了して採点",
                onConfirm: () => {
                    setIsTimerRunning(false);
                    setView('result');
                    closeModal();
                }
                });
            };

            // リセットアクション
            const resetApp = () => {
                showConfirm({
                title: "データのリセット",
                message: "現在の記録を破棄して、最初の画面に戻りますか？",
                confirmText: "リセット",
                isDestructive: true,
                onConfirm: () => {
                    setView('setup');
                    setDriverName('');
                    setEvaluatorName('');
                    setVehicleType('');
                    setRoute('');
                    setDistance('');
                    setTimer(0);
                    setScore(100);
                    setLogs([]);
                    closeModal();
                }
                });
            };

            // --- 画面コンポーネント ---

            // カスタムモーダルコンポーネント
            const Modal = () => {
                if (!modal) return null;
                
                return (
                <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-[100] p-4 animate-in fade-in duration-200">
                    <div className="bg-white rounded-xl shadow-2xl max-w-sm w-full p-6 transform scale-100 transition-all">
                    <h3 className="text-lg font-bold text-gray-900 mb-2">{modal.title}</h3>
                    <p className="text-gray-600 mb-6">{modal.message}</p>
                    
                    <div className="flex gap-3 justify-end">
                        {!modal.isAlert && (
                        <button
                            onClick={closeModal}
                            className="px-4 py-2 text-gray-600 font-medium hover:bg-gray-100 rounded-lg transition"
                        >
                            キャンセル
                        </button>
                        )}
                        <button
                        onClick={modal.onConfirm}
                        className={`px-4 py-2 font-bold text-white rounded-lg shadow-sm transition ${
                            modal.isDestructive 
                            ? 'bg-red-600 hover:bg-red-700' 
                            : modal.isAlert 
                                ? 'bg-blue-600 hover:bg-blue-700'
                                : 'bg-green-600 hover:bg-green-700'
                        }`}
                        >
                        {modal.confirmText || "OK"}
                        </button>
                    </div>
                    </div>
                </div>
                );
            };

            // 1. セットアップ画面
            if (view === 'setup') {
                return (
                <div className="min-h-screen bg-gray-50 p-4 flex items-center justify-center font-sans">
                    <Modal />
                    <div className="bg-white max-w-xl w-full rounded-xl shadow-lg p-8 border border-gray-200">
                    <div className="text-center mb-8">
                        <div className="bg-red-600 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 shadow-md">
                        <AlertTriangle className="text-white w-8 h-8" />
                        </div>
                        <h1 className="text-2xl font-bold text-gray-800">緊急車両<br/>コメンタリー運転評価</h1>
                        <p className="text-gray-500 mt-2 text-sm">消防本部・運転手研修用</p>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div className="md:col-span-1">
                        <label className="block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1">
                            <User className="w-3 h-3"/> 受検者氏名 (必須)
                        </label>
                        <input
                            type="text"
                            value={driverName}
                            onChange={(e) => setDriverName(e.target.value)}
                            className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none transition"
                            placeholder="例: 消防 太郎"
                        />
                        </div>
                        <div className="md:col-span-1">
                        <label className="block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1">
                            <User className="w-3 h-3"/> 評価者氏名
                        </label>
                        <input
                            type="text"
                            value={evaluatorName}
                            onChange={(e) => setEvaluatorName(e.target.value)}
                            className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 outline-none transition"
                            placeholder="例: 司令 次郎"
                        />
                        </div>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div className="md:col-span-1">
                        <label className="block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1">
                            <Truck className="w-3 h-3"/> 車両タイプ (必須)
                        </label>
                        <input
                            type="text"
                            value={vehicleType}
                            onChange={(e) => setVehicleType(e.target.value)}
                            list="vehicle-options"
                            className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 outline-none transition"
                            placeholder="例: ポンプ車、救急車"
                        />
                        <datalist id="vehicle-options">
                            <option value="消防ポンプ自動車" />
                            <option value="水槽付消防ポンプ自動車" />
                            <option value="はしご付消防自動車" />
                            <option value="救急自動車" />
                            <option value="化学消防ポンプ自動車" />
                            <option value="救助工作車" />
                            <option value="指揮車" />
                        </datalist>
                        </div>
                        <div className="md:col-span-1">
                        <label className="block text-sm font-medium text-gray-700 mb-1">実施日</label>
                        <input
                            type="date"
                            value={examDate}
                            onChange={(e) => setExamDate(e.target.value)}
                            className="w-full p-3 border border-gray-300 rounded-lg outline-none"
                        />
                        </div>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
                        <div className="md:col-span-1">
                        <label className="block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1">
                            <MapIcon className="w-3 h-3"/> 走行ルート
                        </label>
                        <input
                            type="text"
                            value={route}
                            onChange={(e) => setRoute(e.target.value)}
                            className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 outline-none transition"
                            placeholder="例: 本署〜国道1号〜本署"
                        />
                        </div>
                        <div className="md:col-span-1">
                        <label className="block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1">
                            <Milestone className="w-3 h-3"/> 走行距離
                        </label>
                        <input
                            type="text"
                            value={distance}
                            onChange={(e) => setDistance(e.target.value)}
                            className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 outline-none transition"
                            placeholder="例: 5.2 km"
                        />
                        </div>
                    </div>

                    <button
                        onClick={startExam}
                        className="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-4 rounded-lg shadow-md transition transform active:scale-95 flex items-center justify-center gap-2"
                    >
                        <CheckCircle className="w-5 h-5" />
                        試験を開始する
                    </button>
                    </div>
                </div>
                );
            }

            // 2. 試験中画面
            if (view === 'exam') {
                return (
                <div className="min-h-screen bg-gray-100 flex flex-col font-sans">
                    <Modal />
                    {/* ヘッダー (固定) */}
                    <header className="sticky top-0 z-50 bg-gray-900 text-white shadow-md no-print">
                    <div className="p-3 flex justify-between items-center max-w-5xl mx-auto">
                        <div className="flex flex-col">
                        <span className="text-xs text-gray-400">受検者 / 車両</span>
                        <span className="font-bold text-lg leading-tight">{driverName} <span className="text-xs font-normal text-gray-400 ml-2">({vehicleType})</span></span>
                        </div>
                        
                        <div className="flex items-center gap-6">
                        <div className={`flex flex-col items-center ${score < PASSING_SCORE ? 'text-red-400' : 'text-green-400'}`}>
                            <span className="text-xs text-gray-400">現在スコア</span>
                            <span className="font-mono text-3xl font-bold">{score}</span>
                        </div>
                        <div className="flex flex-col items-center">
                            <span className="text-xs text-gray-400">経過時間</span>
                            <span className="font-mono text-xl flex items-center gap-1">
                            <Clock className="w-4 h-4" /> {formatTime(timer)}
                            </span>
                        </div>
                        </div>

                        <div className="flex items-center gap-2">
                        <button
                            onClick={resetApp}
                            className="bg-gray-700 hover:bg-gray-600 text-gray-300 px-3 py-2 rounded text-sm font-medium transition"
                            title="最初からやり直す"
                        >
                            中断
                        </button>
                        <button
                            onClick={finishExam}
                            className="bg-red-600 hover:bg-red-700 px-4 py-2 rounded text-sm font-bold shadow transition flex items-center gap-1"
                        >
                            <CheckCircle className="w-4 h-4" />
                            終了
                        </button>
                        </div>
                    </div>
                    </header>

                    {/* メインエリア */}
                    <div className="flex-1 overflow-auto p-2 sm:p-4 max-w-5xl mx-auto w-full grid grid-cols-1 lg:grid-cols-3 gap-4">
                    
                    {/* 左カラム：評価ボタン群 */}
                    <div className="lg:col-span-2 space-y-4 pb-20">
                        {evaluationItems.map((category, idx) => (
                        <div key={idx} className="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
                            <div className={`px-4 py-2 border-b flex items-center gap-2 font-bold ${category.color}`}>
                            {category.icon}
                            {category.category}
                            </div>
                            <div className="p-2 grid grid-cols-2 gap-2">
                            {category.items.map((item) => (
                                <button
                                key={item.id}
                                onClick={() => handleDeduct(item)}
                                className="flex flex-col items-center justify-center p-4 bg-gray-50 hover:bg-red-50 border border-gray-200 rounded-lg active:bg-red-100 active:border-red-300 transition duration-150 group"
                                >
                                <span className="text-sm sm:text-base font-bold text-gray-700 group-hover:text-red-700 mb-1 text-center">
                                    {item.label}
                                </span>
                                <span className="text-xs font-bold text-red-500 bg-red-50 px-2 py-0.5 rounded-full border border-red-100">
                                    -{item.points}点
                                </span>
                                </button>
                            ))}
                            </div>
                        </div>
                        ))}
                    </div>

                    {/* 右カラム：履歴（間違い修正用） */}
                    <div className="lg:col-span-1">
                        <div className="bg-white rounded-lg shadow-sm border border-gray-200 h-full max-h-[500px] flex flex-col">
                        <div className="p-3 border-b bg-gray-50 font-bold text-gray-700 flex items-center justify-between">
                            <span>減点履歴</span>
                            <span className="text-xs font-normal text-gray-500">タップして取消</span>
                        </div>
                        <div className="flex-1 overflow-y-auto p-2 space-y-2">
                            {logs.length === 0 ? (
                            <div className="text-center py-10 text-gray-400 text-sm">
                                減点項目はありません。<br/>安全運転継続中。
                            </div>
                            ) : (
                            logs.map((log) => (
                                <div key={log.id} className="flex items-center justify-between p-3 bg-red-50 border border-red-100 rounded animate-in fade-in slide-in-from-top-2">
                                <div className="flex flex-col">
                                    <span className="text-xs text-gray-500">{formatTime(log.time)}</span>
                                    <span className="text-sm font-bold text-gray-800">{log.label}</span>
                                </div>
                                <div className="flex items-center gap-3">
                                    <span className="font-bold text-red-600">-{log.points}</span>
                                    <button 
                                    onClick={() => undoDeduct(log.id)}
                                    className="p-1.5 bg-white text-gray-400 hover:text-blue-600 rounded shadow-sm border border-gray-200 hover:border-blue-300 transition"
                                    title="この減点を取り消す"
                                    >
                                    <RotateCcw className="w-4 h-4" />
                                    </button>
                                </div>
                                </div>
                            ))
                            )}
                        </div>
                        </div>
                    </div>
                    </div>
                </div>
                );
            }

            // 3. 結果画面
            if (view === 'result') {
                const isPassed = score >= PASSING_SCORE;

                return (
                <div className="min-h-screen bg-gray-50 p-4 font-sans print:bg-white">
                    <Modal />
                    <div className="max-w-2xl mx-auto bg-white shadow-xl rounded-xl overflow-hidden print:shadow-none print:border print:border-gray-300">
                    
                    {/* 結果ヘッダー */}
                    <div className={`${isPassed ? 'bg-green-600' : 'bg-red-600'} text-white p-6 text-center print:bg-white print:text-black print:border-b`}>
                        <h2 className="text-xl font-bold opacity-90">コメンタリー運転 評価結果</h2>
                        <div className="mt-4 flex items-center justify-center gap-6">
                        <div className="text-center">
                            <span className="block text-sm opacity-80">スコア</span>
                            <span className="text-6xl font-black tracking-tighter">{score}</span>
                            <span className="text-xl">/100</span>
                        </div>
                        <div className="w-px h-16 bg-white opacity-30 print:bg-black"></div>
                        <div className="text-center">
                            <span className="block text-sm opacity-80">判定</span>
                            <span className="text-4xl font-bold">{isPassed ? '合 格' : '不合格'}</span>
                        </div>
                        </div>
                    </div>

                    {/* 詳細情報 */}
                    <div className="p-8">
                        <div className="grid grid-cols-2 gap-x-6 gap-y-4 mb-8 text-sm">
                        <div className="border-b pb-2">
                            <span className="block text-gray-500 text-xs">受検者名</span>
                            <span className="block text-lg font-bold text-gray-800">{driverName}</span>
                        </div>
                        <div className="border-b pb-2">
                            <span className="block text-gray-500 text-xs">使用車両</span>
                            <span className="block text-lg font-bold text-gray-800">{vehicleType}</span>
                        </div>
                        <div className="border-b pb-2">
                            <span className="block text-gray-500 text-xs">実施日</span>
                            <span className="block text-base text-gray-800">{examDate}</span>
                        </div>
                        <div className="border-b pb-2">
                            <span className="block text-gray-500 text-xs">評価者名</span>
                            <span className="block text-base text-gray-800">{evaluatorName || '未入力'}</span>
                        </div>
                        <div className="border-b pb-2">
                            <span className="block text-gray-500 text-xs">走行ルート</span>
                            <span className="block text-base text-gray-800">{route || '-'}</span>
                        </div>
                        <div className="border-b pb-2">
                            <span className="block text-gray-500 text-xs">走行距離 / 所要時間</span>
                            <span className="block text-base text-gray-800">
                            {distance ? `${distance} / ` : ''}{formatTime(timer)}
                            </span>
                        </div>
                        </div>

                        <div className="mb-8">
                        <h3 className="font-bold text-gray-800 border-b pb-2 mb-4 flex items-center gap-2">
                            <AlertTriangle className="w-5 h-5 text-red-500" />
                            減点項目一覧
                        </h3>
                        {logs.length === 0 ? (
                            <div className="p-4 bg-green-50 text-green-700 rounded-lg text-center">
                            減点項目はありません。素晴らしい運転でした。
                            </div>
                        ) : (
                            <div className="space-y-3">
                            {logs.slice().reverse().map((log) => (
                                <div key={log.id} className="flex justify-between items-center py-2 border-b border-gray-100 last:border-0">
                                <div className="flex items-center gap-3">
                                    <span className="px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded font-mono">
                                    {formatTime(log.time)}
                                    </span>
                                    <span className="text-gray-800">{log.label}</span>
                                </div>
                                <span className="font-bold text-red-600">-{log.points}</span>
                                </div>
                            ))}
                            </div>
                        )}
                        </div>
                        
                        <div className="flex flex-col gap-3 print:hidden">
                        <div className="space-y-2">
                            <button
                            onClick={() => window.print()}
                            className="w-full bg-gray-800 hover:bg-gray-900 text-white font-bold py-3 rounded-lg flex items-center justify-center gap-2 transition"
                            >
                            <Save className="w-4 h-4" />
                            結果を印刷 / PDF保存
                            </button>
                            <p className="text-xs text-center text-gray-500">
                            ※ボタンが反応しない場合は、ブラウザのメニューから「印刷」を選択してください。
                            </p>
                        </div>
                        
                        <button
                            onClick={resetApp}
                            className="w-full bg-white hover:bg-gray-50 text-gray-600 font-bold py-3 rounded-lg border border-gray-300 flex items-center justify-center gap-2 transition"
                        >
                            <RotateCcw className="w-4 h-4" />
                            新しい試験を開始する
                        </button>
                        </div>
                    </div>
                    </div>
                </div>
                );
            }

            return null;
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
